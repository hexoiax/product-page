<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
:root {
  --green-main: #2ECC71;
  --green-dark: #1FA85C;
  --pastel-1: #ffe7c7;
  --pastel-2: #e8fff4;
}

/* GENERAL */
html, body {
  overflow-x: hidden;
  margin: 0;
  background: #f8fff9;
  font-family: system-ui, sans-serif;
}

/* Fade-in */
.fade { opacity:0; animation:fadeIn 1s ease forwards; }
@keyframes fadeIn {
  from {opacity:0; transform: translateY(20px);}
  to   {opacity:1; transform: translateY(0);}
}

/* PRODUCT LAYOUT */
.product-intro {
  display: flex;
  gap: 30px;
  padding: 30px;
  max-width: 1100px;
  margin: 20px auto;
  border-radius: 18px;
  background: #ffffff;
  box-shadow: 0 6px 25px rgba(0,0,0,0.08);
}

/* CAROUSEL */
.carousel-wrapper {
  width: 100%;
  max-width: 430px;
  overflow: hidden;
  border-radius: 18px;
  background: #f7fff8;
  box-shadow: 0 10px 25px rgba(0,0,0,0.10);
}

.loop-carousel { position: relative; padding: 15px 0 30px; }
.loop-track { display: flex; transition: transform .35s ease; }

.loop-slide {
  width: 80vw;
  max-width: 350px;
  flex-shrink: 0;
  margin-right: 16px;
}
.loop-slide img {
  width: 100%; border-radius: 16px; object-fit: cover; transition: .35s;
}

.loop-slide.active img { transform: scale(1); opacity: 1; }
.loop-slide:not(.active) img { transform: scale(.92); opacity: .75; }

.caption {
  font-size: 15px;
  margin-top: 10px;
  color: #064e3b;
  opacity: 0;
  transform: translateY(8px);
  transition: .35s;
  padding: 0 10px;
}
.loop-slide.active .caption {
  opacity: 1;
  transform: translateY(0);
}

/* PRODUCT INFO */
.product-info { flex: 1; }

.badge {
  display:inline-flex; gap:6px; padding:6px 14px;
  border-radius:999px;
  background: radial-gradient(circle at top left, var(--pastel-1), var(--pastel-2));
  box-shadow:0 6px 14px rgba(0,0,0,0.08);
  font-size:13px; font-weight:600;
  margin-bottom:10px;
}

.rating-line { display:flex; gap:6px; font-size:15px; font-weight:600; color:#166534; margin-bottom:20px; }
.star-icon { color:#FBBF24; }

.price-box { display:flex; gap:12px; align-items:center; margin-bottom:20px; }
.final-price { font-size:32px; font-weight:800; color:#065f46; }
.original-price { text-decoration:line-through; color:#6b7280; }
.discount-red {
  padding:4px 10px; background:#fee2e2; color:#b91c1c;
  border-radius:999px; font-weight:700;
}

.gift-box {
  background:#f0fff4; padding:14px; border-radius:14px;
  border:1px dashed var(--green-main);
  margin-bottom:15px; color:#166534; font-size:14px;
}

.notice { font-size:14px; margin-bottom:25px; font-weight:600; color:#064e3b; }

/* ORDER BUTTON */
.order-btn-wrapper { text-align:center; }

.order-btn {
  background:linear-gradient(90deg,#2ECC71,#1FA85C);
  padding:18px 30px; border-radius:45px; color:white;
  cursor:pointer; font-weight:700; display:inline-block;
  box-shadow:0 8px 22px rgba(31,168,92,0.45);
  transition:.3s;
}
.order-btn:hover { transform: translateY(-4px); }
.btn-title { font-size:19px; font-weight:700; }
.btn-sub { font-size:13px; opacity:.95; margin-top:2px; }

.guarantee { text-align:center; font-size:13px; margin-top:20px; color:#166534; font-style:italic; }

/* SIZE CHIP */
.size-chip {
  padding:8px 14px; border:1px solid #ccc;
  border-radius:18px; background:white;
  cursor:pointer; font-size:15px; transition:.15s;
}
.size-chip:hover { transform:scale(1.08); box-shadow:0 2px 5px rgba(0,0,0,0.15); }

/* ======================
   POPUP ƒê·∫∂T H√ÄNG (A)
====================== */
.popup-overlay {
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.45);
  display: flex; align-items: center; justify-content: center;
  opacity: 0; pointer-events: none;
  transition: .25s ease;
  z-index: 9999;
}

.popup-overlay.active {
  opacity: 1;
  pointer-events: auto;
}

.popup-box {
  width: 92%;
  max-width: 400px;
  background: #fff;
  border-radius: 18px;
  padding: 22px 24px;
  transform: scale(.85);
  opacity: 0;
  transition: .25s ease;
}

.popup-overlay.active .popup-box {
  transform: scale(1);
  opacity: 1;
}

.popup-box input,
.popup-box textarea {
  width: 100%;
  padding: 12px;
  border-radius: 12px;
  border: 1px solid #ccc;
  font-size: 15px;
  margin-bottom: 10px;
}

.lb { font-size:15px; font-weight:600; margin:10px 0 6px; display:block; }

.qty-wrap { position:relative; margin-bottom:14px; }
#qty-selected {
  padding:12px; background:#fff; border-radius:12px;
  border:1px solid #ccc; cursor:pointer;
}
#qty-dropdown {
  display:none; position:absolute; top:calc(100% + 6px); left:0; right:0;
  background:#fff; border-radius:12px; box-shadow:0 4px 8px rgba(0,0,0,0.1);
  max-height:120px; overflow-y:auto; z-index:10;
}

.submit-btn {
  width:100%; padding:14px; background:#2e7d32; color:white;
  border:none; border-radius:14px; font-size:17px; cursor:pointer;
}

/* POPUP SUCCESS */
#success-popup {
  display:none; position:fixed;
  top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.45);
  align-items:center; justify-content:center;
  z-index:99999;
}

.tick-circle {
  width:84px;height:84px;border-radius:50%;
  background-color:#2e7d32;display:flex;
  align-items:center;justify-content:center;
  animation:pulse 1.6s infinite;
}
@keyframes pulse {
  0% { transform: scale(1); box-shadow:0 0 0 0 rgba(46,125,50,0.4); }
  70% { transform: scale(1.05); box-shadow:0 0 0 10px rgba(46,125,50,0); }
  100% { transform: scale(1); box-shadow:0 0 0 0 rgba(46,125,50,0); }
}

@media(max-width:768px){
  .product-intro {flex-direction:column; padding:20px;}
  .carousel-wrapper {max-width:100%;}
}
</style>
</head>

<body>

<!-- PRODUCT INTRO -->
<div class="product-intro fade">

  <!-- SLIDER -->
  <div class="carousel-wrapper">
    <div class="loop-carousel">
      <div class="loop-track" id="track">

        <!-- Clone Last -->
        <div class="loop-slide clone">
          <img src="https://ik.imagekit.io/7q6vhb7ce/sizechart%20copy.jpg">
          <div class="caption">B·∫£ng size chu·∫©n ‚Äì theo chi·ªÅu cao & c√¢n n·∫∑ng.</div>
        </div>

        <!-- REAL SLIDES -->
        <div class="loop-slide"><img src="https://ik.imagekit.io/7q6vhb7ce/A.jpg"><div class="caption">H√¨nh ·∫£nh th·∫≠t ‚Äì cao su √©p nhi·ªát.</div></div>
        <div class="loop-slide"><img src="https://ik.imagekit.io/7q6vhb7ce/B.jpg"><div class="caption">Ch·ªëng th·∫•m n∆∞·ªõc tuy·ªát ƒë·ªëi.</div></div>
        <div class="loop-slide"><img src="https://ik.imagekit.io/7q6vhb7ce/C.jpg"><div class="caption">ƒê∆∞·ªùng √©p nhi·ªát li·ªÅn m·∫°ch.</div></div>
        <div class="loop-slide"><img src="https://ik.imagekit.io/7q6vhb7ce/D.jpg"><div class="caption">D√†y 2 l·ªõp ‚Äì gi·ªØ ·∫•m.</div></div>
        <div class="loop-slide"><img src="https://ik.imagekit.io/7q6vhb7ce/h.jpg"><div class="caption">Ch·ªëng tr∆°n tr∆∞·ª£t.</div></div>
        <div class="loop-slide"><img src="https://ik.imagekit.io/7q6vhb7ce/F.jpg"><div class="caption">Ph√π h·ª£p nam & n·ªØ.</div></div>
        <div class="loop-slide"><img src="https://ik.imagekit.io/7q6vhb7ce/E.jpg"><div class="caption">ƒê·∫ø nguy√™n kh·ªëi ‚Äì b·ªÅn ch·∫Øc.</div></div>
        <div class="loop-slide"><img src="https://ik.imagekit.io/7q6vhb7ce/G.jpg"><div class="caption">Kh·ªõp n·ªëi ch·∫Øc ch·∫Øn.</div></div>

        <div class="loop-slide">
          <img src="https://ik.imagekit.io/7q6vhb7ce/sizechart%20copy.jpg">
          <div class="caption">Ch·ªçn size ƒë√∫ng ƒë·ªÉ tho·∫£i m√°i nh·∫•t.</div>
        </div>

        <!-- Clone First -->
        <div class="loop-slide clone">
          <img src="https://ik.imagekit.io/7q6vhb7ce/A.jpg">
          <div class="caption">H√¨nh ·∫£nh th·∫≠t ‚Äì cao su √©p nhi·ªát.</div>
        </div>

      </div>
    </div>
  </div>

  <!-- PRODUCT INFO -->
  <div class="product-info">

    <div class="badge">‚òÖ Best Seller ‚Ä¢ Kh√°ch mua nhi·ªÅu</div>

    <h1 style="color:#064e3b; font-size:26px; margin:0;">
      Qu·∫ßn Li·ªÅn ·ª¶ng Cao Su 2 L·ªõp Ch·ªëng N∆∞·ªõc - Gi·ªØ ·∫§m
    </h1>

    <div class="rating-line">
      <span class="star-icon">‚òÖ</span> 4.9/5 ‚Ä¢ 18,210 sold
    </div>

    <div class="price-box">
      <div class="final-price">130.000ƒë</div>
      <div class="original-price">200.000ƒë</div>
      <div class="discount-red">-35%</div>
    </div>

    <div class="gift-box">
      üéÅ T·∫∑ng 1 ƒë√¥i gƒÉng tay<br>
      ‚ù§Ô∏è ∆Øu ƒë√£i 20% ‚Äì s·ªë l∆∞·ª£ng c√≥ h·∫°n
    </div>

    <div class="notice">‚ö† L∆∞u √Ω ƒë·∫∑t h√†ng theo size ch√¢n c·ªßa b·∫°n</div>

    <div class="order-btn-wrapper">
      <div class="order-btn" id="openPopup">
        <div class="btn-title">ƒê·∫∑t h√†ng ngay</div>
        <div class="btn-sub">Mi·ªÖn ph√≠ ship to√†n qu·ªëc</div>
      </div>
    </div>

    <div class="guarantee">* N·∫øu kh√¥ng h√†i l√≤ng, c·ª≠a h√†ng h·ªó tr·ª£ ƒë·ªïi tr·∫£ trong 7 ng√†y</div>

  </div>
</div>

<!-- POPUP ORDER -->
<div id="orderPopup" class="popup-overlay">
  <div class="popup-box" id="orderBox">

    <h2 style="margin-top:0;text-align:center;">ƒê·∫∂T H√ÄNG NGAY</h2>

    <input id="name" type="text" placeholder="T√™n kh√°ch h√†ng">
    <input id="phone" type="tel" placeholder="S·ªë ƒëi·ªán tho·∫°i">
    <textarea id="address" placeholder="ƒê·ªãa ch·ªâ giao h√†ng"></textarea>

    <label class="lb">Ch·ªçn Size</label>
    <div id="size-container" style="display:flex;flex-wrap:wrap;gap:8px;margin-bottom:16px;"></div>

    <label class="lb">S·ªë l∆∞·ª£ng</label>
    <div class="qty-wrap">
      <div id="qty-selected">Ch·ªçn s·ªë l∆∞·ª£ng</div>
      <div id="qty-dropdown"></div>
    </div>

    <div id="price-summary" style="display:none;background:#fff;border-radius:14px;padding:14px 16px;box-shadow:0 2px 6px rgba(0,0,0,0.1);margin-bottom:18px;">
      <div>T·∫°m t√≠nh: <b id="subtotal">0‚Ç´</b></div>
      <div style="color:#e53935;">Gi·∫£m 35%: <b id="discount">-0‚Ç´</b></div>
      <div style="font-size:17px;font-weight:bold;">
        T·ªïng thanh to√°n: <span id="total" style="color:#2e7d32;">0‚Ç´</span>
      </div>
      <div style="font-size:14px;color:#2e7d32;">üöö Free Ship to√†n qu·ªëc</div>
    </div>

    <textarea id="note" placeholder="Ghi ch√∫ (tu·ª≥ ch·ªçn)"></textarea>

    <button id="submit-btn" class="submit-btn">G·ª≠i ƒë∆°n h√†ng</button>

  </div>
</div>

<!-- POPUP SUCCESS -->
<div id="success-popup">
  <div style="background:white;padding:24px 26px;border-radius:20px;width:80%;max-width:320px;text-align:center;box-shadow:0 4px 10px rgba(0,0,0,0.15);">
    <div class="tick-circle">
      <svg viewBox="0 0 24 24" fill="none">
        <path d="M6 12.5l4 4L18 8.5" stroke="#fff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>
    <h3 style="color:#2e7d32;margin-top:10px;">ƒê·∫∑t h√†ng th√†nh c√¥ng!</h3>
  </div>
</div>

<!-- ======== JS ======== -->

<script>
/* =========================
   POPUP CENTER MODAL (A)
========================= */
const orderPopup = document.getElementById("orderPopup");
const orderBox = document.getElementById("orderBox");

document.getElementById("openPopup").onclick = () => {
  orderPopup.classList.add("active");
};

// b·∫•m ra ngo√†i ƒë·ªÉ ƒë√≥ng (nh∆∞ng KH√îNG reset data)
orderPopup.addEventListener("click", function(e){
  if(!orderBox.contains(e.target)){
    orderPopup.classList.remove("active");
  }
});

/* =========================
   LOGIC FORM
========================= */
const SCRIPT_URL='https://script.google.com/macros/s/AKfycbwCpEIrkWo_aDGQI3Tek6gKeg2VOTWASXDe59AMRK15kazytqIMrMMAmaYbZ9ynVYmsNA/exec';

const sizes=['36','37','38','39','40','41','42'];
const qtys=['1','2','3','4','5','6','7','8','9','10'];

const sizeContainer=document.getElementById('size-container');
const qtySelected=document.getElementById('qty-selected');
const qtyDropdown=document.getElementById('qty-dropdown');
const priceSummary=document.getElementById('price-summary');
const subtotalEl=document.getElementById('subtotal');
const discountEl=document.getElementById('discount');
const totalEl=document.getElementById('total');
const successPopup=document.getElementById('success-popup');

const basePrice = 200000;

let selectedSizes=[];
let selectedQty=null;

/* Render size */
sizes.forEach(size=>{
  const chip=document.createElement('div');
  chip.textContent=size;
  chip.className='size-chip';
  chip.onclick=()=>{
    if(selectedSizes.includes(size)){
      selectedSizes=selectedSizes.filter(s=>s!==size);
      chip.style.background='white';
      chip.style.color='black';
      chip.style.border='1px solid #ccc';
    } else {
      selectedSizes.push(size);
      chip.style.background='#2e7d32';
      chip.style.color='white';
      chip.style.border='1px solid #2e7d32';
    }
  };
  sizeContainer.appendChild(chip);
});

/* Render qty */
qtys.forEach(qty=>{
  const item=document.createElement('div');
  item.textContent=qty;
  item.style.cssText="padding:10px;cursor:pointer;border-bottom:1px solid #eee;";
  item.onclick=()=>{
    selectedQty=parseInt(qty);
    qtySelected.textContent='S·ªë l∆∞·ª£ng: '+qty;
    qtyDropdown.style.display='none';
    updatePrice();
  };
  qtyDropdown.appendChild(item);
});

qtySelected.onclick=()=>{
  qtyDropdown.style.display = qtyDropdown.style.display==='block'?'none':'block';
};

document.addEventListener('click',e=>{
  if(!qtySelected.contains(e.target)&&!qtyDropdown.contains(e.target)){
    qtyDropdown.style.display='none';
  }
});

/* Price */
function updatePrice(){
  if(!selectedQty) return;

  const subtotal = basePrice * selectedQty;
  const discount = subtotal * 0.35;
  const total = subtotal - discount;

  subtotalEl.textContent=subtotal.toLocaleString('vi-VN')+"‚Ç´";
  discountEl.textContent="-"+discount.toLocaleString('vi-VN')+"‚Ç´";
  totalEl.textContent=total.toLocaleString('vi-VN')+"‚Ç´";

  priceSummary.style.display='block';
}

/* Submit */
document.getElementById("submit-btn").onclick = () => {

  const name=document.getElementById('name').value.trim();
  const phone=document.getElementById('phone').value.trim();
  const address=document.getElementById('address').value.trim();
  const note=document.getElementById('note').value.trim();

  if(!name) return alert("Vui l√≤ng nh·∫≠p t√™n");
  if(!phone) return alert("Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i");
  if(!address) return alert("Vui l√≤ng nh·∫≠p ƒë·ªãa ch·ªâ");
  if(selectedSizes.length===0) return alert("Vui l√≤ng ch·ªçn size");
  if(!selectedQty) return alert("Vui l√≤ng ch·ªçn s·ªë l∆∞·ª£ng");

  orderPopup.classList.remove("active");

  fetch(SCRIPT_URL,{
    method:'POST',
    body:new URLSearchParams({
      name,phone,address,
      sizes:selectedSizes.join(', '),
      quantity:selectedQty,
      note
    })
  });

  // show success popup
  successPopup.style.display="flex";

  // RESET SAU G·ª¨I
  setTimeout(()=>{
    successPopup.style.display="none";

    document.getElementById('name').value="";
    document.getElementById('phone').value="";
    document.getElementById('address').value="";
    document.getElementById('note').value="";

    selectedSizes=[];
    selectedQty=null;

    qtySelected.textContent="Ch·ªçn s·ªë l∆∞·ª£ng";
    priceSummary.style.display="none";

    document.querySelectorAll('.size-chip').forEach(c=>{
      c.style.background='white';
      c.style.color='black';
      c.style.border='1px solid #ccc';
    });

  },3500);
};
</script>

<!-- SLIDER JS -->
<script>
const track=document.getElementById("track");
const slides=document.querySelectorAll(".loop-slide");
let current=1;

function slideWidth(){
  return slides[0].offsetWidth+16;
}

function goTo(i){
  current=i;
  track.style.transition="transform .35s ease";
  track.style.transform=`translateX(-${current*slideWidth()}px)`;
  slides.forEach(s=>s.classList.remove("active"));
  slides[current].classList.add("active");
}

setTimeout(()=>goTo(1),80);

track.addEventListener("transitionend",()=>{
  if(slides[current].classList.contains("clone")){
    track.style.transition="none";
    current=(current===slides.length-1)?1:slides.length-2;
    track.style.transform=`translateX(-${current*slideWidth()}px)`;
    slides.forEach(s=>s.classList.remove("active"));
    slides[current].classList.add("active");
  }
});

let startX=0;
track.addEventListener("touchstart",e=>{
  startX=e.touches[0].clientX;
});
track.addEventListener("touchend",e=>{
  const diff=startX-e.changedTouches[0].clientX;
  if(diff>40) goTo(current+1);
  else if(diff<-40) goTo(current-1);
});

window.addEventListener("resize",()=>{
  track.style.transition="none";
  track.style.transform=`translateX(-${current*slideWidth()}px)`;
});
</script>

</body>
</html>
